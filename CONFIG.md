# VolGuard Pro: 尾部风控高级策略看板 (v5.0) - 系统配置与规范文档

## 一、项目定性与核心参数

这是一个基于**纯量化统计与极严苛尾部风控精神**设计的做空波动率（Short Volatility）专业大屏。
核心标的极其明确：**上证50ETF期权 (对应现货: 510050.SS)**。

### 1.1 核心风控阈值配置
| 参数 | 系统推荐值 | 理论内涵 |
|------|------------|----------|
| **建仓虚值目标(OTM)** | **11.0%** | 在确认泡沫期（BSADF触发）时，只卖出偏离现价极其遥远、距离发生实质履约风险概率极低的深浅虚值期权，获取稳健 Theta。 |
| **绝对止损认怂线** | **6.4%** | 若标的行情出现向不利方向单边运动，导致原本11%的深度虚值被压缩至不足6.4%（或被计算跌破 95% GARCH VaR 警戒线），**必须无条件即时止损平仓**，防止千日砍柴一日烧。 |
| **GARCH 滚动窗口** | **250个交易日** | 确保波动率引擎能够覆盖过去一整年的市场周期剧烈波动。 |
| **盘中RV预警阈值** | **历史均值+2σ** | 用于盘中捕捉日线级别尚未来得及破位的“黑天鹅”突发脉冲。 |

---

## 二、数据流架构 (v5.0 SWR 毫秒级闪充引擎)

在 v5.0 版本中，为了彻底歼灭网络 I/O 带来的 UI 阻塞假死问题，系统架构全面转向量化级实时渲染模式 Stale-While-Revalidate (SWR)：

### 2.1 长周期历史底座：yfinance (日度缓存)
*   **接入品种**：`510050.SS`
*   **拉取频率与 TTL**：12 小时生命周期。
*   **机制**：如果在 12 小时内，直接返回本地极速库 `etf_510050.csv`；若过期，**前端直接返回旧实例完成 K 线重绘并解除阻塞**，同时下发异步 Daemon Thread 静默去 Yahoo 金融节点请求 5 年期序列，下载完毕后悄无声息覆盖旧文件。下一次重绘即是新数据。

### 2.2 盘中高频探测雷达：akshare (60秒极速微缓存)
*   **获取目标**：`option_current_em()`（期权全景竞价与持仓量/成交量）
*   **拉取频率与 TTL**：60 秒极短生命周期。
*   **机制**：完全抹除 `st.cache_data` 的锁死状态。每逢 60 秒 TTL 逾期，应用同样采用“极速抛出当前陈旧盘口 -> 衍造后台子线程 -> 扒取东方财富实时接口 -> 复写期权 CSV”的操作。这样即便东方财富接口受限导致 10 秒延迟，也绝对不会波及操作仪盘的 60FPS 顺滑度。

---

## 三、部署及运行规范

### 3.1 Python 基础依赖
建议锁定 Python 3.9 ~ 3.12 虚拟环境：
```bash
pip install streamlit pandas numpy akshare arch statsmodels scipy yfinance pyecharts streamlit-echarts
```

### 3.2 运行指令
在项目根目录拉起服务：
```bash
streamlit run app.py
```
> *注：服务运行产生的 `data` 目录为系统 SWR 机制的物理生命线，切勿在运行期锁定此目录的读写权限，否则后台更新线程将爆出权限错误导致数据静止。*

---

## 四、安全与交易法则（Must Obeys）

1.  **绝不扛单法则**：系统的核心胜率来自于对剩余 10% 尾部风险的绝对切割。当期权表单中出现红块预警，或者现价打入 GARCH `±var_95` 的认怂边界极限时，系统即判定防线崩溃。此时**不论账面面临多大浮亏，必须买入平仓**。
2.  **不接飞刀法则**：在 BSADF 指示器没有向上击破 95% 置信度红线“泡沫发酵期测试”之前，即便波动率短期走高也不要盲目进行赌博式卖出，极易被单侧行情顺劈。
3.  **极低杠杆运行**：卖方策略自带天然无限裸露敞口。请严格按初始保证金为 1 的情况下，寻求 5%~8% 的年化绝对收益来建立头寸，严禁将多余保证金用于重复开仓暴露。
